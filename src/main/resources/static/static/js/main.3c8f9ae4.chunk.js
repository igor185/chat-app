(window.webpackJsonp=window.webpackJsonp||[]).push([[0],{250:function(e,t,a){},300:function(e,t,a){e.exports=a(537)},305:function(e,t,a){},306:function(e,t,a){},307:function(e,t,a){},308:function(e,t,a){},459:function(e,t,a){},474:function(e,t,a){},483:function(e,t,a){},518:function(e,t,a){},537:function(e,t,a){"use strict";a.r(t);var n={};a.r(n),a.d(n,"clearStore",function(){return M}),a.d(n,"fetchChats",function(){return z}),a.d(n,"fetchMessages",function(){return H}),a.d(n,"closeChat",function(){return B}),a.d(n,"togglePanel",function(){return G}),a.d(n,"newMessage",function(){return R}),a.d(n,"loginUser",function(){return U}),a.d(n,"regUser",function(){return J}),a.d(n,"changePage",function(){return W}),a.d(n,"fetchUser",function(){return q}),a.d(n,"search",function(){return X}),a.d(n,"toggleSearch",function(){return Y}),a.d(n,"newChat",function(){return Z}),a.d(n,"addChatToList",function(){return K}),a.d(n,"deleteMessage",function(){return V}),a.d(n,"deleteMessageDone",function(){return $}),a.d(n,"editMessage",function(){return Q}),a.d(n,"editMessageDone",function(){return ee});var r=a(0),c=a.n(r),s=a(65),o=a.n(s),i=(a(305),a(306),a(307),a(26)),l=(a(308),a(94)),u=a(97),d=a(23),m="FETCH_CHATS",h="FETCH_CHATS_DONE",p="FETCH_MESSAGES",f="FETCH_MESSAGES_DONE",g="CLOSE_CHAT",b="TOGGLE_PANEL",E="TOGGLE_SEARCH",v="ADD_NEW_MESSAGE",O="LOGIN",y="LOGIN_FAIL",j="REG",w="REG_FAIL",C="CHANGE_PAGE",k="REMOVE_STORE",x="FETCH_USER",S="FETCH_USER_DONE",N="SEARCH",A="SEARCH_DONE",P="CREATE_CHAT",_="CREATE_CHAT_DONE",I="ADD_CHAT_TO_LIST",F="DELETE_MESSAGE",T="DELETE_MESSAGE_DONE",L="EDIT_MESSAGE",D="EDIT_MESSAGE_DONE",M=function(){return{type:k}},z=function(){return{type:m}},H=function(e,t){return{type:p,payload:{id:e,user:t}}},B=function(){return{type:g}},G=function(){return{type:b}},R=function(e){return{type:v,payload:{message:e}}},U=function(e,t){return{type:O,payload:{login:e,password:t}}},J=function(e,t,a){return{type:j,payload:{login:e,password:t,avatar:a}}},W=function(e){return{type:C,payload:e}},q=function(){return{type:x}},X=function(e){return{type:N,payload:{search:e}}},Y=function(){return{type:E}},Z=function(e,t){return{type:P,payload:{userId:e,user:t}}},K=function(e,t){return{type:I,payload:{chatId:e,user:t}}},V=function(e,t){return{type:F,payload:{messageId:e,chatId:t}}},$=function(e){return{type:T,payload:{message:e}}},Q=function(e,t,a){return{type:L,payload:{messageId:e,chatId:t,message:a}}},ee=function(e){return{type:D,payload:{message:e}}},te=a(25),ae=a(288),ne=a(550),re=a(553),ce=Object(te.b)(function(e){return{}},function(e){return{actions:Object(d.bindActionCreators)(n,e)}})(function(e){return c.a.createElement(ne.a,{open:e.close,closeOnDimmerClick:!0,onClose:function(){return e.setClose(!1)},centered:!1},c.a.createElement(ne.a.Header,null,c.a.createElement("div",{className:"header-wrap-view"},e.user.username,e.isEdit&&c.a.createElement("div",{className:"icon-wrap",onClick:e.onLogOut},c.a.createElement(l.a,{icon:u.c})))),c.a.createElement(ne.a.Content,{image:!0},c.a.createElement(ae.a,{wrapped:!0,size:"medium",src:e.user.avatar,circular:!0}),c.a.createElement(ne.a.Description,null,c.a.createElement(re.a,null,"Default Profile Image"),c.a.createElement("p",null,"We've found the following gravatar image associated with your e-mail address."),c.a.createElement("p",null,"Is it okay to use this photo?"))))}),se=Object(te.b)(function(e){return{chat:e.chat,user:e.user}},function(e){return{actions:Object(d.bindActionCreators)(n,e)}})(function(e){var t=Object(r.useState)(!1),a=Object(i.a)(t,2),n=a[0],s=a[1],o=Object(r.useState)(null),d=Object(i.a)(o,2),m=d[0],h=d[1],p=function(e){e&&(s(!0),h(e))},f=e.chat.user;return c.a.createElement("div",{className:"header-wrap"},c.a.createElement("div",{className:"left-side"},c.a.createElement("div",{className:"icon-wrap",onClick:function(){return e.actions.togglePanel()}},c.a.createElement(l.a,{icon:u.a})),c.a.createElement("div",{className:"icon-wrap",onClick:function(){return e.actions.toggleSearch()}},c.a.createElement(l.a,{icon:u.b}))),f&&c.a.createElement("div",{className:"header-user",onClick:function(){return p(f)}},c.a.createElement("div",{className:"avatar"},c.a.createElement(ae.a,{avatar:!0,src:f.avatar})),c.a.createElement("div",{className:"name"},f.username)),c.a.createElement("div",{className:"right-size",onClick:function(){return p(e.user.data)}},c.a.createElement(ae.a,{avatar:!0,src:e.user.data.avatar})),m&&c.a.createElement(ce,{isEdit:m.id===e.user.data.id,close:n,setClose:s,user:m,actions:e.actions,onLogOut:function(){localStorage.removeItem("token"),e.actions.clearStore()}}))}),oe=(a(459),a(20)),ie=a.n(oe),le=a(79),ue=a(42),de=a(272),me=a.n(de),he=a(98),pe=a.n(he),fe=a(131),ge=a.n(fe),be="https://igor-babin-chat-java.herokuapp.com",Ee="".concat(be,"/ws"),ve="".concat(be,"/api/chats"),Oe="".concat(be,"/api/chat/"),ye="".concat(be,"/api/auth/login"),je="".concat(be,"/api/me"),we="".concat(be,"/req"),Ce="".concat(be,"/api/users"),ke="".concat(be,"/api/chat"),xe="".concat(be,"/api/message"),Se="".concat(be,"/api/uploadFile");pe.a.extend(ge.a);var Ne=function(){return{headers:{Authorization:"Bearer ".concat(localStorage.getItem("token"))}}},Ae=function(e){return pe()(e).fromNow()},Pe=function(e){return Object(ue.a)(e||[]).sort(function(e,t){var a=e.message?e.message.time:0;return(t.message?t.message.time:0)-a})},_e=function(){var e=Object(le.a)(ie.a.mark(function e(t){var a,n;return ie.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return(a=new FormData).append("file",t),e.next=4,fetch(Se,{headers:{Authorization:"Bearer ".concat(localStorage.getItem("token"))},method:"POST",body:a});case 4:return n=e.sent,console.log(n),e.next=8,n.json();case 8:return n=e.sent,e.abrupt("return",n);case 10:case"end":return e.stop()}},e)}));return function(t){return e.apply(this,arguments)}}(),Ie=function(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1],a=t?1e3:1024;if(Math.abs(e)<a)return e+" B";var n=t?["kB","MB","GB","TB","PB","EB","ZB","YB"]:["KiB","MiB","GiB","TiB","PiB","EiB","ZiB","YiB"],r=-1;do{e/=a,++r}while(Math.abs(e)>=a&&r<n.length-1);return e.toFixed(1)+" "+n[r]},Fe=a(273),Te=a.n(Fe),Le=function(e){var t=e.name,a=e.date,n=e.message,r=e.id,s=e.avatar,o=e.show,i=void 0!==o&&o,l=n?n.message||(n.file?c.a.createElement("span",{className:"file"},"file"):""):"";return c.a.createElement("div",{className:"chat-elem-wrap ".concat(e.chatId===r?"toggled":""),onClick:function(){return e.onClick()}},c.a.createElement("div",{className:"avatar"},c.a.createElement(ae.a,{avatar:!0,src:s})),c.a.createElement("div",{className:"info"},c.a.createElement("div",{className:"name-wrap"},c.a.createElement("div",{className:"name"},t),c.a.createElement("div",{className:"date"},a&&Ae(a))),i||"string"!==typeof l?l:c.a.createElement(Te.a,{text:l,length:21})))},De=(a(474),a(66)),Me=a(549),ze=a(546),He=function(e){var t=Object(r.useState)(""),a=Object(i.a)(t,2),n=a[0],s=a[1];return c.a.createElement(c.a.Fragment,null,c.a.createElement(Me.a,{onSubmit:function(){return e.actions.search(n)}},c.a.createElement(ze.a,{loading:e.search.isFetching,value:n,icon:"user",placeholder:"Search...",iconPosition:"left",onChange:function(e,t){return s(t.value)}})),c.a.createElement(c.a.Fragment,null,e.search.data&&(e.search.data.length>0?c.a.createElement(c.a.Fragment,null,e.search.data.map(function(t){return c.a.createElement(Le,{key:t.id,id:t.id,name:t.username,avatar:t.avatar,onClick:function(){return function(t){var a=e.chatList.data.find(function(e){return e.user.id===t.id});if(a)return e.actions.fetchMessages(a.chat.id,t);e.actions.newChat(t.id)}(t)},show:!0})})):c.a.createElement(re.a,{as:"h4",icon:!0,textAlign:"center"},c.a.createElement(De.a,{name:"window close outline",size:"mini"}),"Not found"))))},Be=Object(te.b)(function(e){return{chatList:e.chatList,chat:e.chat,search:e.search}},function(e){return{actions:Object(d.bindActionCreators)(n,e)}})(function(e){Object(r.useEffect)(function(){e.chatList.data||e.actions.fetchChats()},[e.actions]);return c.a.createElement("div",{className:"chat-list-wrap"},e.search.isOpen?c.a.createElement(He,e):c.a.createElement(c.a.Fragment,null,e.chatList.data&&e.chatList.data.map(function(t){return t&&t.message&&c.a.createElement(Le,{key:t.chat.id,id:t.chat.id,chatId:e.chat.id,name:t.user.username,date:t.message.time,message:t.message,avatar:t.user.avatar,onClick:function(){return function(t){t.chat.id!==e.chat.id?e.actions.fetchMessages(t.chat.id,t.user):e.actions.closeChat()}(t)}})})))}),Ge=a(548),Re=(a(483),a(539)),Ue=a(551),Je=a(547),We=a(282),qe=a.n(We),Xe=a(283),Ye=a.n(Xe),Ze={},Ke=function(e,t,a){return Ze.send(e,t,a)},Ve=function(e,t){if(Ze.connected)console.log("already connected");else{var a=t.user.data;(Ze=Ye.a.over(new qe.a(Ee))).connect({},function(){console.log("Connected",t.user),Ze.subscribe("/res/new-message/".concat(a.id),function(t){var a=t.body;return e.newMessage(JSON.parse(a))}),Ze.subscribe("/res/new-chat/".concat(a.id),function(t){var n=t.body,r=JSON.parse(n);e.addChatToList(r.chatId,r.user1.id===a.id?r.user1:r.user2)}),Ze.subscribe("/res/delete-message/".concat(a.id),function(t){var a=t.body,n=JSON.parse(a);console.log(n),e.deleteMessageDone(n),e.fetchChats()}),Ze.subscribe("/res/edit-message/".concat(a.id),function(t){var a=t.body,n=JSON.parse(a);e.editMessageDone(n),e.fetchChats()})})}},$e=Object(te.b)(function(e){return{user:e.user,chat:e.chat}},function(e){return{actions:Object(d.bindActionCreators)(n,e)}})(function(e){var t=Object(r.useState)(""),a=Object(i.a)(t,2),n=a[0],s=a[1],o=Object(r.useState)(!1),l=Object(i.a)(o,2),u=l[0],d=l[1],m=Object(r.useState)(!1),h=Object(i.a)(m,2),p=h[0],f=h[1],g=Object(r.useState)(null),b=Object(i.a)(g,2),E=b[0],v=b[1],O=function(){var e=Object(le.a)(ie.a.mark(function e(t){var a;return ie.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:a=t.target,f(!0),d(!0),_e(a.files[0]).then(function(e){console.log(e),v(e),d(!1)}).catch(console.log);case 4:case"end":return e.stop()}},e)}));return function(t){return e.apply(this,arguments)}}(),y=function(){f(!1),(n||E)&&(Ke("/req/new-message",{},JSON.stringify({chatId:e.chat.id,userId:e.user.data.id,message:n,file:E})),s(""))};return c.a.createElement(Me.a,{onSubmit:function(e){return y()},className:"input-wrapper"},c.a.createElement(ze.a,{placeholder:"Type a message...",fluid:!0,value:n,onChange:function(e,t){return s(t.value)}}),c.a.createElement(Re.a,{color:"teal",icon:!0,as:"label"},c.a.createElement(De.a,{name:"paperclip"}),c.a.createElement("input",{name:"image",type:"file",onChange:O,hidden:!0})),c.a.createElement(ne.a,{open:p,basic:!0,size:"small"},c.a.createElement(ne.a.Content,null,c.a.createElement(re.a,{as:"h3",textAlign:"center",className:"white-header"},"Message with attached"),c.a.createElement(Ue.a,{icon:!0},u?c.a.createElement(De.a,{name:"circle notched",loading:!0}):c.a.createElement(De.a,{name:"file"}),c.a.createElement(Ue.a.Content,null,c.a.createElement(Ue.a.Header,null,E&&E.fileName),E&&Ie(E.size))),c.a.createElement(Me.a,null,c.a.createElement(Je.a,{value:n,onChange:function(e,t){return s(t.value)},style:{minHeight:200}}))),c.a.createElement(ne.a.Actions,{className:"action-btn"},c.a.createElement(Re.a,{color:"green",inverted:!0,onClick:function(){return u||y()}},c.a.createElement(De.a,{name:"save",disabled:u})," Save"),c.a.createElement(Re.a,{color:"blue",inverted:!0,onClick:function(){return f(!1)}},c.a.createElement(De.a,{name:"cancel"})," Cancel"))))});a(518);pe.a.extend(ge.a);var Qe=Object(te.b)(function(){return{}},function(e){return{actions:Object(d.bindActionCreators)(n,e)}})(function(e){var t=e.message,a=e.user,n=e.actions,s=t.user.id===a.id,o=Object(r.useState)(!1),l=Object(i.a)(o,2),u=l[0],d=l[1],m=Object(r.useState)(!1),h=Object(i.a)(m,2),p=h[0],f=h[1],g=Object(r.useState)(t.message),b=Object(i.a)(g,2),E=b[0],v=b[1];return c.a.createElement("div",{className:"message-item ".concat(u?"to-delete":""),style:{alignItems:s?"flex-end":"flex-start"}},c.a.createElement("p",{className:s?"from-me":"from-them"},t.file&&(-1===t.file.fileType.indexOf("image")?c.a.createElement(Ue.a,{icon:!0,compact:!0,size:"mini",info:!0},c.a.createElement(De.a,{name:"file",onClick:function(){return t.file&&window.open(t.file.fileDownloadUri,"_blank")}}),c.a.createElement(Ue.a.Content,null,c.a.createElement(Ue.a.Header,null,t.file&&t.file.fileName),t.file&&Ie(t.file.size))):c.a.createElement(c.a.Fragment,null,c.a.createElement("div",{style:{marginBottom:10}},c.a.createElement(ae.a,{src:t.file.fileDownloadUri,size:"medium",wrapped:!0,as:"a",href:t.file.fileDownloadUri,target:"_blank"})))),t.message,c.a.createElement("span",{className:"info-block"},c.a.createElement("span",{className:"time"},Ae(t.time)),s&&c.a.createElement("span",{className:"icons"},c.a.createElement(ne.a,{trigger:c.a.createElement(De.a,{name:"trash",size:"small",onClick:function(){return d(!0)}}),open:u,onClose:function(){return d(!1)},basic:!0,size:"small"},c.a.createElement(ne.a.Content,null,c.a.createElement(re.a,{as:"h3",textAlign:"center",className:"white-header"},"Are you sure you want to delete the message?")),c.a.createElement(ne.a.Actions,{className:"action-btn"},c.a.createElement(Re.a,{color:"red",onClick:function(){d(!1),n.deleteMessage(t.id,t.chat.id)},inverted:!0},c.a.createElement(De.a,{name:"trash"})," Delete"),c.a.createElement(Re.a,{color:"green",onClick:function(){return d(!1)},inverted:!0},c.a.createElement(De.a,{name:"cancel"})," Cancel"))),c.a.createElement(ne.a,{trigger:c.a.createElement(De.a,{name:"edit",size:"small",onClick:function(){return f(!0)}}),open:p,onClose:function(){return f(!1)},basic:!0,size:"small"},c.a.createElement(ne.a.Content,null,c.a.createElement(re.a,{as:"h3",textAlign:"center",className:"white-header"},"Edit message"),c.a.createElement(Me.a,null,c.a.createElement(Je.a,{value:E,onChange:function(e,t){return v(t.value)},style:{minHeight:200}}))),c.a.createElement(ne.a.Actions,{className:"action-btn"},c.a.createElement(Re.a,{color:"green",onClick:function(){f(!1),n.editMessage(t.id,t.chat.id,E)},inverted:!0},c.a.createElement(De.a,{name:"edit"})," Edit"),c.a.createElement(Re.a,{color:"blue",onClick:function(){return f(!1)},inverted:!0},c.a.createElement(De.a,{name:"cancel"})," Cancel")))))),c.a.createElement(ae.a,{avatar:!0,src:t.user.avatar}))}),et=function(e){return c.a.createElement(c.a.Fragment,null," ",(e.chat.data||[]).map(function(t){return c.a.createElement(Qe,{key:t.id,message:t,user:e.user})}))},tt=Object(te.b)(function(e){return{chat:e.chat,user:e.user}},function(e){return{actions:Object(d.bindActionCreators)(n,e)}})(function(e){return c.a.createElement("div",{className:"chat-page-wrapper"},e.chat.isOpen?e.chat.isFetching?c.a.createElement("div",{className:"loader-wrap"},c.a.createElement(Ge.a,{active:!0,inline:"centered"})):c.a.createElement(c.a.Fragment,null,c.a.createElement("div",{className:"messages-wrap"},c.a.createElement(et,{chat:e.chat,user:e.user.data})),c.a.createElement("div",{className:"input-wrap"},c.a.createElement($e,null))):c.a.createElement("div",{style:{alignItems:"center",display:"flex",justifyContent:"center",flexDirection:"column",height:"100%"}},c.a.createElement(re.a,{as:"h3",textAlign:"center"},"Select chat to start texting")))}),at=a(555),nt=Object(te.b)(function(e){return{state:e,showPanel:e.showPanel,user:e.user}},function(e){return{actions:Object(d.bindActionCreators)(n,e)}})(function(e){return Object(r.useEffect)(function(){e.actions&&e.user.data&&(console.log("init"),Ve(e.actions,e.state))},[e.actions,e.user]),Object(r.useEffect)(function(){e.actions.fetchUser()},[e.actions]),e.user.data&&!e.user.isFetching?c.a.createElement("div",{className:"main-wrapper"},c.a.createElement("div",{style:{background:"white"}},c.a.createElement(se,null),c.a.createElement("div",{className:"content-wrap"},e.showPanel&&c.a.createElement(Be,e),c.a.createElement(tt,null)))):c.a.createElement(at.a,{active:!0,inverted:!0},c.a.createElement(Ge.a,{inverted:!0}))}),rt=(a(519),a(554)),ct=a(552),st=Object(te.b)(function(e){return{showPanel:e.showPanel,loginPage:e.loginPage}},function(e){return{actions:Object(d.bindActionCreators)(n,e)}})(function(e){var t=Object(r.useState)(""),a=Object(i.a)(t,2),n=a[0],s=a[1],o=Object(r.useState)(""),l=Object(i.a)(o,2),u=l[0],d=l[1];return c.a.createElement(rt.a,{textAlign:"center",style:{position:"absolute",top:"30%",left:"35%"},verticalAlign:"middle"},c.a.createElement(rt.a.Column,{style:{width:500,background:"white"}},c.a.createElement(re.a,{as:"h2",textAlign:"center"},"Login to your account"),c.a.createElement(Me.a,{size:"large"},c.a.createElement(ct.a,{stacked:!0},c.a.createElement(Me.a.Input,{fluid:!0,icon:"user",iconPosition:"left",placeholder:"E-mail address",value:n,onChange:function(e,t){return s(t.value)}}),c.a.createElement(Me.a.Input,{fluid:!0,icon:"lock",iconPosition:"left",placeholder:"Password",type:"password",value:u,onChange:function(e,t){return d(t.value)},error:e.loginPage&&!!e.loginPage.error}),c.a.createElement(Re.a,{className:"color-btn",fluid:!0,size:"large",onClick:function(){return e.actions.loginUser(n,u)},loading:e.loginPage&&e.loginPage.isFetching},"Login"))),e.loginPage&&!!e.loginPage.error&&c.a.createElement(Ue.a,{error:!0,content:e.loginPage.error}),c.a.createElement(Ue.a,null,"New to us? ",c.a.createElement("a",{href:"#",onClick:function(){return e.actions.changePage("reg")}},"Sign Up"))))}),ot=a(284),it=a.n(ot),lt=(a(520),Object(ue.a)(function(e){for(var t=[],a=0;a<e;a++)t[a]=me.a.avatar();return t}(14))),ut=Object(te.b)(function(e){return{showPanel:e.showPanel,regPage:e.regPage}},function(e){return{actions:Object(d.bindActionCreators)(n,e)}})(function(e){var t=Object(r.useState)(""),a=Object(i.a)(t,2),n=a[0],s=a[1],o=Object(r.useState)(""),l=Object(i.a)(o,2),u=l[0],d=l[1],m=Object(r.useState)(""),h=Object(i.a)(m,2),p=h[0],f=h[1];return c.a.createElement(rt.a,{textAlign:"center",style:{position:"absolute",top:"20%",left:"35%"},verticalAlign:"middle"},c.a.createElement(rt.a.Column,{style:{width:500,background:"white"}},c.a.createElement(re.a,{as:"h2",textAlign:"center"},"Sign up to your account"),c.a.createElement(Me.a,{size:"large"},c.a.createElement(ct.a,{stacked:!0},c.a.createElement(Me.a.Input,{fluid:!0,icon:"user",iconPosition:"left",placeholder:"E-mail address",value:n,onChange:function(e,t){return s(t.value)}}),c.a.createElement(Me.a.Input,{fluid:!0,icon:"lock",iconPosition:"left",placeholder:"Password",type:"password",value:u,onChange:function(e,t){return d(t.value)}}),c.a.createElement(re.a,{as:"h4",textAlign:"left"},"Choose a photo"),c.a.createElement(it.a,{images:lt.map(function(e,t){return{src:e,value:t}}),onPick:function(e){return f(e.src)}}),c.a.createElement(Re.a,{className:"color-btn",fluid:!0,size:"large",onClick:function(){return e.actions.regUser(n,u,p)},loading:e.regPage&&e.regPage.isFetching},"Sign up"))),e.regPage&&!!e.regPage.error&&c.a.createElement(Ue.a,{error:!0,content:e.regPage.error}),c.a.createElement(Ue.a,null,"Already has account? ",c.a.createElement("a",{href:"#",onClick:function(){return e.actions.changePage("login")}},"Login"))))}),dt=(a(250),function(){particlesJS("particles-js",{particles:{number:{value:80,density:{enable:!0,value_area:800}},color:{value:"#ffffff"},shape:{type:"circle",stroke:{width:0,color:"#000000"},polygon:{nb_sides:5},image:{src:"img/github.svg",width:100,height:100}},opacity:{value:.5,random:!1,anim:{enable:!1,speed:1,opacity_min:.1,sync:!1}},size:{value:5,random:!0,anim:{enable:!1,speed:40,size_min:.1,sync:!1}},line_linked:{enable:!0,distance:150,color:"#ffffff",opacity:.4,width:1},move:{enable:!0,speed:2,direction:"none",random:!1,straight:!1,out_mode:"out",attract:{enable:!1,rotateX:600,rotateY:1200}}},interactivity:{detect_on:"canvas",events:{onhover:{enable:!0,mode:"repulse"},onclick:{enable:!0,mode:"push"},resize:!0},modes:{grab:{distance:400,line_linked:{opacity:1}},bubble:{distance:400,size:40,duration:2,opacity:8,speed:3},repulse:{distance:200},push:{particles_nb:4},remove:{particles_nb:2}}},retina_detect:!0,config_demo:{hide_card:!1,background_color:"#b61924",background_image:"",background_position:"50% 50%",background_repeat:"no-repeat",background_size:"cover"}})}),mt=function(e){return Object(r.useEffect)(function(){dt()},[]),c.a.createElement(c.a.Fragment,null,c.a.createElement("div",{id:"particles-js"}),"login"===e.page?c.a.createElement(st,null):c.a.createElement(ut,null))},ht=Object(te.b)(function(e){return{page:e.page}})(function(e){switch(e.page){case"login":case"reg":return c.a.createElement(mt,{page:e.page});default:return c.a.createElement("div",{className:"App"},c.a.createElement(nt,null))}});Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));var pt=a(28),ft=a(285),gt=a.n(ft),bt=a(11),Et=function(){var e=Object(le.a)(ie.a.mark(function e(t,a){var n,r,c;return ie.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return n=a&&a.headers?Object(bt.a)({},Ne().headers,{},a.headers):Ne().headers,a&&a.body&&(n=new Headers(Object(bt.a)({"Content-Type":"application/json"},n))),e.next=4,fetch(t,Object(bt.a)({},a||{},{headers:n}));case 4:if(r=e.sent,console.log(r),r.ok){e.next=16;break}return console.error(r),e.next=10,r.json();case 10:if(c=e.sent,console.log(c),"Token has expired"!==c.message){e.next=15;break}return localStorage.removeItem("token"),e.abrupt("return",window.location.reload());case 15:throw new Error(c.message);case 16:return e.next=18,r.json();case 18:return e.abrupt("return",e.sent);case 19:case"end":return e.stop()}},e)}));return function(t,a){return e.apply(this,arguments)}}(),vt=ie.a.mark(At),Ot=ie.a.mark(Pt),yt=ie.a.mark(_t),jt=ie.a.mark(It),wt=ie.a.mark(Ft),Ct=ie.a.mark(Tt),kt=ie.a.mark(Lt),xt=ie.a.mark(Dt),St=ie.a.mark(Mt),Nt=ie.a.mark(zt);function At(e){var t;return ie.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,Et(ve);case 3:return t=e.sent,e.next=6,Object(pt.a)({type:h,payload:t});case 6:e.next=11;break;case 8:e.prev=8,e.t0=e.catch(0),console.log(e.t0);case 11:case"end":return e.stop()}},vt,null,[[0,8]])}function Pt(e){var t;return ie.a.wrap(function(a){for(;;)switch(a.prev=a.next){case 0:return a.prev=0,a.next=3,Et(Oe+e.payload.id,{headers:Ne().headers});case 3:return t=a.sent,a.next=6,Object(pt.a)({type:f,payload:t});case 6:a.next=11;break;case 8:a.prev=8,a.t0=a.catch(0),console.log(a.t0);case 11:case"end":return a.stop()}},Ot,null,[[0,8]])}function _t(e){var t;return ie.a.wrap(function(a){for(;;)switch(a.prev=a.next){case 0:return a.prev=0,a.next=3,Et(ye,{method:"POST",body:JSON.stringify({username:e.payload.login,password:e.payload.password}),headers:{"X-Requested-With":"XMLHttpRequest"}});case 3:return t=a.sent,localStorage.setItem("token",t.token),a.next=7,Object(pt.a)({type:C,payload:"chat"});case 7:a.next=14;break;case 9:return a.prev=9,a.t0=a.catch(0),a.next=13,Object(pt.a)({type:y,payload:{error:a.t0.message}});case 13:console.error(a.t0);case 14:case"end":return a.stop()}},yt,null,[[0,9]])}function It(e){var t;return ie.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,Et(je,{method:"GET",headers:Ne().headers});case 3:return t=e.sent,e.next=6,Object(pt.a)({type:S,payload:{user:t}});case 6:e.next=14;break;case 8:return e.prev=8,e.t0=e.catch(0),console.error(e.t0),localStorage.removeItem("token"),e.next=14,Object(pt.a)({type:k});case 14:case"end":return e.stop()}},jt,null,[[0,8]])}function Ft(e){var t,a,n,r;return ie.a.wrap(function(c){for(;;)switch(c.prev=c.next){case 0:return t=e.payload,a=t.login,n=t.password,r=t.avatar,c.prev=1,c.next=4,gt()({method:"POST",url:we,data:{username:a,password:n,avatar:r}});case 4:return c.sent,c.next=7,Object(pt.a)({type:O,payload:{login:a,password:n}});case 7:c.next=14;break;case 9:return c.prev=9,c.t0=c.catch(1),c.next=13,Object(pt.a)({type:w,payload:{error:c.t0.message}});case 13:console.error(c.t0);case 14:case"end":return c.stop()}},wt,null,[[1,9]])}function Tt(e){var t;return ie.a.wrap(function(a){for(;;)switch(a.prev=a.next){case 0:return a.prev=0,a.next=3,Et(Ce+"?search=".concat(e.payload.search));case 3:return t=a.sent,a.next=6,Object(pt.a)({type:A,payload:t});case 6:a.next=11;break;case 8:a.prev=8,a.t0=a.catch(0),console.error(a.t0);case 11:case"end":return a.stop()}},Ct,null,[[0,8]])}function Lt(e){var t;return ie.a.wrap(function(a){for(;;)switch(a.prev=a.next){case 0:return a.prev=0,a.next=3,Et(ke,{method:"PUT",body:JSON.stringify({userId:e.payload.userId})});case 3:return t=a.sent,a.next=6,Object(pt.a)({type:_,payload:{chatId:t.chatId}});case 6:a.next=11;break;case 8:a.prev=8,a.t0=a.catch(0),console.error(a.t0);case 11:case"end":return a.stop()}},kt,null,[[0,8]])}function Dt(e){return ie.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,Et(xe+"/".concat(e.payload.messageId),{method:"DELETE",body:JSON.stringify({chatId:e.payload.chatId})});case 3:t.next=8;break;case 5:t.prev=5,t.t0=t.catch(0),console.log(t.t0);case 8:case"end":return t.stop()}},xt,null,[[0,5]])}function Mt(e){return ie.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,Et(xe+"/".concat(e.payload.messageId),{method:"POST",body:JSON.stringify({chatId:e.payload.chatId,message:e.payload.message})});case 3:t.next=8;break;case 5:t.prev=5,t.t0=t.catch(0),console.log(t.t0);case 8:case"end":return t.stop()}},St,null,[[0,5]])}function zt(){return ie.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Object(pt.b)(m,At);case 2:return e.next=4,Object(pt.b)(p,Pt);case 4:return e.next=6,Object(pt.b)(O,_t);case 6:return e.next=8,Object(pt.b)(x,It);case 8:return e.next=10,Object(pt.b)(j,Ft);case 10:return e.next=12,Object(pt.b)(N,Tt);case 12:return e.next=14,Object(pt.b)(P,Lt);case 14:return e.next=16,Object(pt.b)(F,Dt);case 16:return e.next=18,Object(pt.b)(L,Mt);case 18:case"end":return e.stop()}},Nt)}var Ht={chatList:{data:null,isFetching:!1},user:{isFetching:!1,data:null},chat:{id:null,isFetching:!1,isOpen:!1,data:[],user:null},showPanel:!0,page:localStorage.getItem("token")&&"undefined"!==localStorage.getItem("token")?"chat":"login",search:{isFetching:!1,isOpen:!1}};function Bt(){var e,t,a,n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:Ht,r=arguments.length>1?arguments[1]:void 0;switch(r.type){case m:return Object(bt.a)({},n,{chatList:Object(bt.a)({},n.chatList,{isFetching:!0})});case b:return Object(bt.a)({},n,{showPanel:!n.showPanel});case E:return Object(bt.a)({},n,{search:Object(bt.a)({},n.search,{isOpen:!n.search.isOpen}),showPanel:!0});case h:return Object(bt.a)({},n,{chatList:Object(bt.a)({},n.chatList,{data:Pe(r.payload),isFetching:!1})});case p:return Object(bt.a)({},n,{chat:Object(bt.a)({},n.chat,{id:r.payload.id,isFetching:!0,isOpen:!0,user:r.payload.user})});case f:return Object(bt.a)({},n,{chat:Object(bt.a)({},n.chat,{data:r.payload,isFetching:!1})});case v:return t=r.payload.message,e=Object(ue.a)(n.chatList.data||[]).map(function(e){return e.chat.id===t.chat.id&&(e.message=t),e}),Object(bt.a)({},n,{chatList:Object(bt.a)({},n.chatList,{data:Pe(e)}),chat:Object(bt.a)({},n.chat,{data:n.chat.id===t.chat.id?[].concat(Object(ue.a)(n.chat.data||[]),[r.payload.message]):n.chat.data})});case C:return Object(bt.a)({},n,{page:r.payload});case k:return Object(bt.a)({},Ht,{page:"login"});case x:return Object(bt.a)({},n,{user:Object(bt.a)({},n.user,{isFetching:!0})});case S:return Object(bt.a)({},n,{user:Object(bt.a)({},n.user,{isFetching:!1,data:r.payload.user})});case O:return Object(bt.a)({},n,{loginPage:{isFetching:!0,error:null}});case y:return Object(bt.a)({},n,{loginPage:{isFetching:!1,error:r.payload.error}});case j:return Object(bt.a)({},n,{regPage:{isFetching:!0,error:null}});case w:return Object(bt.a)({},n,{regPage:{isFetching:!1,error:r.payload.error}});case N:return Object(bt.a)({},n,{search:Object(bt.a)({},n.search,{isFetching:!0})});case A:return Object(bt.a)({},n,{search:Object(bt.a)({},n.search,{isFetching:!1,data:r.payload})});case P:return Object(bt.a)({},n,{chat:Object(bt.a)({},n.chat,{isFetching:!0,isOpen:!0,user:r.payload.user})});case _:return Object(bt.a)({},n,{chat:Object(bt.a)({},n.chat,{id:r.payload.chatId,isFetching:!1,data:[]})});case I:return(e=Object(ue.a)(n.chatList.data||[])).push({chat:{id:r.payload.chatId},message:null,user:r.payload.user}),Object(bt.a)({},n,{chatList:Object(bt.a)({},n.chatList,{data:Pe(e)})});case T:return(t=r.payload.message).chat.id!==n.chat.id?n:(a=Object(ue.a)(n.chat.data||[]).map(function(e){return e.id===t.id?void 0:e}).filter(function(e){return e}),Object(bt.a)({},n,{chat:Object(bt.a)({},n.chat,{data:a})}));case D:return(t=r.payload.message).chat.id!==n.chat.id?n:(a=Object(ue.a)(n.chat.data||[]).map(function(e){return e.id===t.id?t:e}),Object(bt.a)({},n,{chat:Object(bt.a)({},n.chat,{data:a})}));case g:return Object(bt.a)({},n,{chat:Ht.chat});default:return n}}var Gt=a(287),Rt=a(286),Ut=function(){var e=Object(Gt.a)(),t=Object(d.createStore)(Bt,Object(Rt.composeWithDevTools)(Object(d.applyMiddleware)(e)));return e.run(zt),t}();o.a.render(c.a.createElement(te.a,{store:Ut},c.a.createElement(ht,null)),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then(function(e){e.unregister()})}},[[300,1,2]]]);
//# sourceMappingURL=main.3c8f9ae4.chunk.js.map