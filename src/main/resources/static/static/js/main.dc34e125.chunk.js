(window.webpackJsonp=window.webpackJsonp||[]).push([[0],{194:function(e,t,a){},242:function(e,t,a){e.exports=a(443)},247:function(e,t,a){},248:function(e,t,a){},249:function(e,t,a){},250:function(e,t,a){},257:function(e,t,a){},337:function(e,t,a){},338:function(e,t,a){},443:function(e,t,a){"use strict";a.r(t);var n={};a.r(n),a.d(n,"clearStore",function(){return P}),a.d(n,"fetchChats",function(){return x}),a.d(n,"fetchMessages",function(){return S}),a.d(n,"togglePanel",function(){return C}),a.d(n,"newMessage",function(){return _}),a.d(n,"loginUser",function(){return A}),a.d(n,"regUser",function(){return N}),a.d(n,"changePage",function(){return F}),a.d(n,"fetchUser",function(){return T});var r=a(0),c=a.n(r),o=a(53),i=a.n(o),s=(a(247),a(248),a(249),a(250),a(104)),l=a(105),u=a(22),d="FETCH_CHATS",m="FETCH_CHATS_DONE",p="FETCH_MESSAGES",g="FETCH_MESSAGES_DONE",f="TOGGLE_PANEL",h="ADD_NEW_MESSAGE",b="LOGIN",E="LOGIN_FAIL",v="REG",O="REG_FAIL",w="CHANGE_PAGE",j="REMOVE_STORE",y="FETCH_USER",k="FETCH_USER_DONE",P=function(){return{type:j}},x=function(){return{type:d}},S=function(e){return{type:p,payload:{id:e}}},C=function(){return{type:f}},_=function(e){return{type:h,payload:{message:e}}},A=function(e,t){return{type:b,payload:{login:e,password:t}}},N=function(e,t,a){return{type:v,payload:{login:e,password:t,avatar:a}}},F=function(e){return{type:w,payload:e}},T=function(){return{type:y}},L=a(26),I=Object(L.b)(function(e){return{}},function(e){return{actions:Object(u.bindActionCreators)(n,e)}})(function(e){return c.a.createElement("div",{className:"header-wrap"},c.a.createElement("div",{className:"left-side"},c.a.createElement("div",{className:"icon-wrap",onClick:function(){return e.actions.togglePanel()}},c.a.createElement(s.a,{icon:l.a})),c.a.createElement("div",{className:"icon-wrap"},c.a.createElement(s.a,{icon:l.b}))),c.a.createElement("div",{className:"right-size"},c.a.createElement("div",{className:"icon-wrap",onClick:function(){localStorage.removeItem("token"),e.actions.clearStore()}},c.a.createElement(s.a,{icon:l.c}))))}),G=(a(257),a(455)),M=function(e){var t=e.name,a=(e.date,e.message),n=e.id;return c.a.createElement("div",{className:"chat-elem-wrap",onClick:function(){return e.onClick(n)}},c.a.createElement(G.a.Group,null,c.a.createElement(G.a,null,c.a.createElement(G.a.Avatar,{src:"https://react.semantic-ui.com/images/avatar/small/joe.jpg"}),c.a.createElement(G.a.Content,null,c.a.createElement(G.a.Author,{as:"a"},t),c.a.createElement(G.a.Metadata,null,c.a.createElement("div",null,"Today at 5:42PM")),c.a.createElement(G.a.Text,null,a?a.message:"")))))},z=(a(337),Object(L.b)(function(e){return{chatList:e.chatList}},function(e){return{actions:Object(u.bindActionCreators)(n,e)}})(function(e){return Object(r.useEffect)(function(){e.chatList.data||e.actions.fetchChats()},[e.actions]),c.a.createElement(c.a.Fragment,null,c.a.createElement("div",{className:"chat-list-wrap"},e.chatList.data&&e.chatList.data.map(function(t){return c.a.createElement(M,{key:t.chat.id,id:t.chat.id,name:t.user.username,date:t.time,message:t.message,onClick:function(a){return e.actions.fetchMessages(t.chat.id)}})})))})),H=a(452),R=(a(338),a(453)),U=a(451),D=a(21),J=a(208),W=a.n(J),q=a(209),B=a.n(q),X="http://localhost:8080",V="".concat(X,"/ws"),Y="".concat(X,"/api/chats"),$="".concat(X,"/api/chat/"),K="".concat(X,"/api/auth/login"),Q="".concat(X,"/api/me"),Z="".concat(X,"/req"),ee=B.a.over(new W.a(V)),te=Object(D.a)({},ee,{send:ee.send.bind(ee),connect:function(e){ee.connect({},function(){console.log("Connected"),ee.subscribe("/res/new-message",function(t){var a=t.body;return e.newMessage(JSON.parse(a))})})}}),ae=function(){return c.a.createElement(R.a,{onSubmit:function(e){return t=e.currentTarget.getElementsByTagName("input")[0].value,void te.send("/req/new-message",{},JSON.stringify({chatId:4,userId:1,message:t}));var t}},c.a.createElement(U.a,{placeholder:"Type a message...",fluid:!0}))},ne=a(137),re=a.n(ne),ce=a(222),oe=a.n(ce);re.a.extend(oe.a);var ie=function(e){return c.a.createElement(G.a,null,c.a.createElement(G.a.Avatar,{src:"https://react.semantic-ui.com/images/avatar/small/joe.jpg"}),c.a.createElement(G.a.Content,null,c.a.createElement(G.a.Author,{as:"a"},e.user.username),c.a.createElement(G.a.Metadata,null,c.a.createElement("div",null,re()(e.time).fromNow())),c.a.createElement(G.a.Text,null,e.message),c.a.createElement(G.a.Actions,null,c.a.createElement(G.a.Action,null,"Reply"))))},se=function(e){return c.a.createElement(c.a.Fragment,null," ",e.chat.data.map(function(e){return c.a.createElement(ie,e)}))},le=Object(L.b)(function(e){return{chat:e.chat}},function(e){return{actions:Object(u.bindActionCreators)(n,e)}})(function(e){return c.a.createElement("div",{className:"chat-page-wrapper"},e.chat.isOpen?e.chat.isFetching?c.a.createElement("div",{className:"loader-wrap"},c.a.createElement(H.a,{active:!0,inline:"centered"})):c.a.createElement(c.a.Fragment,null,c.a.createElement("div",{className:"messages-wrap"},c.a.createElement(G.a.Group,null,c.a.createElement(se,e))),c.a.createElement("div",{className:"input-wrap"},c.a.createElement(ae,null))):"close")}),ue=a(457),de=Object(L.b)(function(e){return{showPanel:e.showPanel,user:e.user}},function(e){return{actions:Object(u.bindActionCreators)(n,e)}})(function(e){return Object(r.useEffect)(function(){te.connect(e.actions)},[e.actions]),Object(r.useEffect)(function(){e.actions.fetchUser()},[e.actions]),e.user.data&&!e.user.isFetching?c.a.createElement("div",{className:"main-wrapper"},c.a.createElement("div",{style:{background:"white"}},c.a.createElement(I,null),c.a.createElement("div",{className:"content-wrap"},e.showPanel&&c.a.createElement(z,e),c.a.createElement(le,null)))):c.a.createElement(ue.a,{active:!0,inverted:!0},c.a.createElement(H.a,{inverted:!0}))}),me=(a(412),a(54)),pe=a(459),ge=a(458),fe=a(460),he=a(444),be=a(456),Ee=Object(L.b)(function(e){return{showPanel:e.showPanel,loginPage:e.loginPage}},function(e){return{actions:Object(u.bindActionCreators)(n,e)}})(function(e){var t=Object(r.useState)(""),a=Object(me.a)(t,2),n=a[0],o=a[1],i=Object(r.useState)(""),s=Object(me.a)(i,2),l=s[0],u=s[1];return c.a.createElement(pe.a,{textAlign:"center",style:{position:"absolute",top:"30%",left:"35%"},verticalAlign:"middle"},c.a.createElement(pe.a.Column,{style:{width:500,background:"white"}},c.a.createElement(ge.a,{as:"h2",textAlign:"center"},"Login to your account"),c.a.createElement(R.a,{size:"large"},c.a.createElement(fe.a,{stacked:!0},c.a.createElement(R.a.Input,{fluid:!0,icon:"user",iconPosition:"left",placeholder:"E-mail address",value:n,onChange:function(e,t){return o(t.value)}}),c.a.createElement(R.a.Input,{fluid:!0,icon:"lock",iconPosition:"left",placeholder:"Password",type:"password",value:l,onChange:function(e,t){return u(t.value)},error:e.loginPage&&!!e.loginPage.error}),c.a.createElement(he.a,{className:"color-btn",fluid:!0,size:"large",onClick:function(){return e.actions.loginUser(n,l)},loading:e.loginPage&&e.loginPage.isFetching},"Login"))),c.a.createElement(be.a,null,"New to us? ",c.a.createElement("a",{href:"#",onClick:function(){return e.actions.changePage("reg")}},"Sign Up"))))}),ve=a(103),Oe=a(223),we=a.n(Oe),je=(a(413),a(224)),ye=a.n(je),ke=function(){return{headers:{Authorization:"Bearer ".concat(localStorage.getItem("token"))}}},Pe=Object(ve.a)(function(e){for(var t=[],a=0;a<e;a++)t[a]=ye.a.avatar();return t}(14)),xe=Object(L.b)(function(e){return{showPanel:e.showPanel,regPage:e.regPage}},function(e){return{actions:Object(u.bindActionCreators)(n,e)}})(function(e){var t=Object(r.useState)(""),a=Object(me.a)(t,2),n=a[0],o=a[1],i=Object(r.useState)(""),s=Object(me.a)(i,2),l=s[0],u=s[1],d=Object(r.useState)(""),m=Object(me.a)(d,2),p=m[0],g=m[1];return c.a.createElement(pe.a,{textAlign:"center",style:{position:"absolute",top:"20%",left:"35%"},verticalAlign:"middle"},c.a.createElement(pe.a.Column,{style:{width:500,background:"white"}},c.a.createElement(ge.a,{as:"h2",textAlign:"center"},"Sign up to your account"),c.a.createElement(R.a,{size:"large"},c.a.createElement(fe.a,{stacked:!0},c.a.createElement(R.a.Input,{fluid:!0,icon:"user",iconPosition:"left",placeholder:"E-mail address",value:n,onChange:function(e,t){return o(t.value)}}),c.a.createElement(R.a.Input,{fluid:!0,icon:"lock",iconPosition:"left",placeholder:"Password",type:"password",value:l,onChange:function(e,t){return u(t.value)}}),c.a.createElement(ge.a,{as:"h4",textAlign:"left"},"Choose a photo"),c.a.createElement(we.a,{images:Pe.map(function(e,t){return{src:e,value:t}}),onPick:function(e){return g(e.src)}}),e.regPage&&e.regPage.error&&c.a.createElement(be.a,{error:!0,content:e.regPage.error}),c.a.createElement(he.a,{className:"color-btn",fluid:!0,size:"large",onClick:function(){return e.actions.regUser(n,l,p)},loading:e.regPage&&e.regPage.isFetching},"Sign up"))),c.a.createElement(be.a,null,"Already has account? ",c.a.createElement("a",{href:"#",onClick:function(){return e.actions.changePage("login")}},"Login"))))}),Se=(a(194),function(){particlesJS("particles-js",{particles:{number:{value:80,density:{enable:!0,value_area:800}},color:{value:"#ffffff"},shape:{type:"circle",stroke:{width:0,color:"#000000"},polygon:{nb_sides:5},image:{src:"img/github.svg",width:100,height:100}},opacity:{value:.5,random:!1,anim:{enable:!1,speed:1,opacity_min:.1,sync:!1}},size:{value:5,random:!0,anim:{enable:!1,speed:40,size_min:.1,sync:!1}},line_linked:{enable:!0,distance:150,color:"#ffffff",opacity:.4,width:1},move:{enable:!0,speed:2,direction:"none",random:!1,straight:!1,out_mode:"out",attract:{enable:!1,rotateX:600,rotateY:1200}}},interactivity:{detect_on:"canvas",events:{onhover:{enable:!0,mode:"repulse"},onclick:{enable:!0,mode:"push"},resize:!0},modes:{grab:{distance:400,line_linked:{opacity:1}},bubble:{distance:400,size:40,duration:2,opacity:8,speed:3},repulse:{distance:200},push:{particles_nb:4},remove:{particles_nb:2}}},retina_detect:!0,config_demo:{hide_card:!1,background_color:"#b61924",background_image:"",background_position:"50% 50%",background_repeat:"no-repeat",background_size:"cover"}})}),Ce=function(e){return Object(r.useEffect)(function(){Se()},[]),c.a.createElement(c.a.Fragment,null,c.a.createElement("div",{id:"particles-js"}),"login"===e.page?c.a.createElement(Ee,null):c.a.createElement(xe,null))},_e=Object(L.b)(function(e){return{page:e.page}})(function(e){switch(e.page){case"login":case"reg":return c.a.createElement(Ce,{page:e.page});default:return c.a.createElement("div",{className:"App"},c.a.createElement(de,null))}});Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));var Ae=a(27),Ne=a.n(Ae),Fe=a(30),Te=a(225),Le=a.n(Te),Ie=a(226),Ge=function(){var e=Object(Ie.a)(Ne.a.mark(function e(t,a){var n;return Ne.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,fetch(t,a);case 2:if((n=e.sent).ok){e.next=6;break}throw console.error(n),new Error(n.statusText+" "+n.status);case 6:return e.next=8,n.json();case 8:return e.abrupt("return",e.sent);case 9:case"end":return e.stop()}},e)}));return function(t,a){return e.apply(this,arguments)}}(),Me=Ne.a.mark(Je),ze=Ne.a.mark(We),He=Ne.a.mark(qe),Re=Ne.a.mark(Be),Ue=Ne.a.mark(Xe),De=Ne.a.mark(Ve);function Je(e){var t;return Ne.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,Ge(Y,{headers:ke().headers});case 3:return t=e.sent,e.next=6,Object(Fe.a)({type:m,payload:t});case 6:e.next=11;break;case 8:e.prev=8,e.t0=e.catch(0),console.log(e.t0);case 11:case"end":return e.stop()}},Me,null,[[0,8]])}function We(e){var t;return Ne.a.wrap(function(a){for(;;)switch(a.prev=a.next){case 0:return a.prev=0,a.next=3,Ge($+e.payload.id,{headers:ke().headers});case 3:return t=a.sent,a.next=6,Object(Fe.a)({type:g,payload:t});case 6:a.next=11;break;case 8:a.prev=8,a.t0=a.catch(0),console.log(a.t0);case 11:case"end":return a.stop()}},ze,null,[[0,8]])}function qe(e){var t;return Ne.a.wrap(function(a){for(;;)switch(a.prev=a.next){case 0:return a.prev=0,a.next=3,Ge(K,{method:"POST",body:JSON.stringify({username:e.payload.login,password:e.payload.password}),headers:{"X-Requested-With":"XMLHttpRequest"}});case 3:return t=a.sent,localStorage.setItem("token",t.token),a.next=7,Object(Fe.a)({type:w,payload:"chat"});case 7:a.next=14;break;case 9:return a.prev=9,a.t0=a.catch(0),a.next=13,Object(Fe.a)({type:E});case 13:console.error(a.t0);case 14:case"end":return a.stop()}},He,null,[[0,9]])}function Be(e){var t;return Ne.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,Ge(Q,{method:"GET",headers:ke().headers});case 3:return t=e.sent,e.next=6,Object(Fe.a)({type:k,payload:{user:t}});case 6:e.next=14;break;case 8:return e.prev=8,e.t0=e.catch(0),console.error(e.t0),localStorage.removeItem("token"),e.next=14,Object(Fe.a)({type:j});case 14:case"end":return e.stop()}},Re,null,[[0,8]])}function Xe(e){var t,a,n,r;return Ne.a.wrap(function(c){for(;;)switch(c.prev=c.next){case 0:return t=e.payload,a=t.login,n=t.password,r=t.avatar,c.prev=1,c.next=4,Le()({method:"POST",url:Z,data:{username:a,password:n,avatar:r}});case 4:return c.sent,c.next=7,Object(Fe.a)({type:b,payload:{login:a,password:n}});case 7:c.next=14;break;case 9:return c.prev=9,c.t0=c.catch(1),c.next=13,Object(Fe.a)({type:O,payload:{error:c.t0}});case 13:console.error(c.t0);case 14:case"end":return c.stop()}},Ue,null,[[1,9]])}function Ve(){return Ne.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Object(Fe.b)(d,Je);case 2:return e.next=4,Object(Fe.b)(p,We);case 4:return e.next=6,Object(Fe.b)(b,qe);case 6:return e.next=8,Object(Fe.b)(y,Be);case 8:return e.next=10,Object(Fe.b)(v,Xe);case 10:case"end":return e.stop()}},De)}var Ye={chatList:{data:null,isFetching:!1},user:{isFetching:!1,data:null},chat:{isFetching:!1,isOpen:!1,data:[]},showPanel:!0,page:localStorage.getItem("token")&&"undefined"!==localStorage.getItem("token")?"chat":"login"};function $e(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:Ye,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case d:return Object(D.a)({},e,{chatList:Object(D.a)({},e.chatList,{isFetching:!0})});case f:return Object(D.a)({},e,{showPanel:!e.showPanel});case m:return Object(D.a)({},e,{chatList:Object(D.a)({},e.chatList,{data:t.payload,isFetching:!1})});case p:return Object(D.a)({},e,{chat:Object(D.a)({},e.chat,{isFetching:!0,isOpen:!0})});case g:return Object(D.a)({},e,{chat:Object(D.a)({},e.chat,{data:t.payload,isFetching:!1})});case h:return Object(D.a)({},e,{chat:Object(D.a)({},e.chat,{data:[].concat(Object(ve.a)(e.chat.data||[]),[t.payload.message])})});case w:return Object(D.a)({},e,{page:t.payload});case j:return Object(D.a)({},Ye,{page:"login"});case y:return Object(D.a)({},e,{user:Object(D.a)({},e.user,{isFetching:!0})});case k:return Object(D.a)({},e,{user:Object(D.a)({},e.user,{isFetching:!1,data:t.payload.user})});case b:return Object(D.a)({},e,{loginPage:{isFetching:!0,error:null}});case E:return Object(D.a)({},e,{loginPage:{isFetching:!1,error:!0}});case v:return Object(D.a)({},e,{regPage:{isFetching:!0,error:null}});case O:return Object(D.a)({},e,{regPage:{isFetching:!1,error:t.payload.error}});default:return e}}var Ke=a(228),Qe=a(227),Ze=function(){var e=Object(Ke.a)(),t=Object(u.createStore)($e,Object(Qe.composeWithDevTools)(Object(u.applyMiddleware)(e)));return e.run(Ve),t}();i.a.render(c.a.createElement(L.a,{store:Ze},c.a.createElement(_e,null)),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then(function(e){e.unregister()})}},[[242,1,2]]]);
//# sourceMappingURL=main.dc34e125.chunk.js.map